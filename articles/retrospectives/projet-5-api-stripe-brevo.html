<h1>Projet 5 : API Stripe, Brevo et Webhooks</h1>

<!-- Metadata block -->
<div class="metadata">
    <p>ğŸ·ï¸ <strong>CatÃ©gorie:</strong> RÃ©trospectives</p>
    <p>ğŸ¯ <strong>Niveau:</strong> IntermÃ©diaire</p>
    <p>ğŸ” <strong>Mots-clÃ©s:</strong> API REST, Stripe Checkout, Brevo, Webhooks, Xano, Paiement, Email transactionnel, Get All Raw Input, IntÃ©gration externe, SÃ©curitÃ© API</p>
    <p>ğŸ“… <strong>Mise Ã  jour:</strong> Novembre 2025</p>
    <p>â±ï¸ <strong>Temps passÃ©:</strong> ~6h</p>
    <p>âš™ï¸ <strong>Stack:</strong> WeWeb + Xano + Stripe + Brevo</p>
</div>

<!-- TL;DR -->
<div class="tldr">
âœ… <strong>TL;DR :</strong>
Projet centrÃ© sur l'intÃ©gration d'APIs externes (Stripe pour le paiement, Brevo pour les emails). Le flux complet WeWeb â†’ Xano â†’ Stripe â†’ webhook â†’ Xano â†’ Brevo semblait simple sur le papier. RÃ©alitÃ© : 80% du temps passÃ© Ã  comprendre comment rÃ©cupÃ©rer les donnÃ©es du webhook Stripe dans Xano (solution : "Get All Raw Input"). Une fois ce blocage rÃ©solu, l'envoi d'email Brevo bouclÃ© en 10 minutes. ProblÃ¨me non rÃ©solu : validation de la clÃ© Stripe qui renvoie toujours false.
</div>

<h2>ğŸ“ RÃ©sumÃ© du projet</h2>

<p>
Le Projet 5 porte sur la <strong>mise en place d'APIs</strong> : crÃ©er une API REST interne, intÃ©grer une API de paiement (Stripe) et une API d'emailing transactionnel (Brevo). L'objectif est de connecter tous ces services pour crÃ©er un flux complet de rÃ©servation avec paiement et confirmation par email.
</p>

<p>
Le flux attendu : validation de session â†’ appel Stripe â†’ paiement â†’ dÃ©clencheur webhook â†’ appel API Xano â†’ mise Ã  jour du statut de rÃ©servation â†’ email de confirmation via Brevo.
</p>

<h2>ğŸ¯ Objectifs initiaux</h2>

<p>Ce que le projet demandait :</p>

<ul>
    <li><strong>CrÃ©er une API REST interne</strong> sur Xano pour gÃ©rer les rÃ©servations</li>
    <li><strong>IntÃ©grer Stripe Checkout</strong> pour le paiement sÃ©curisÃ©</li>
    <li><strong>Configurer les webhooks Stripe</strong> pour recevoir les confirmations de paiement</li>
    <li><strong>IntÃ©grer Brevo</strong> pour l'envoi d'emails transactionnels</li>
    <li><strong>SÃ©curiser les Ã©changes</strong> avec authentification par tokens</li>
</ul>

<h2>ğŸš€ PremiÃ¨res impressions</h2>

<h3>ğŸ“‹ Prise de connaissance rapide</h3>

<p>
Je commence par parcourir l'intÃ©gralitÃ© du projet et lister mes questions. <strong>Pas grand-chose Ã  signaler</strong>, le flux semble clair sur le papier. J'ai dÃ©jÃ  un compte Stripe d'un projet prÃ©cÃ©dent, Ã§a devrait faciliter les choses.
</p>

<div class="callout callout-tip">
ğŸ’¡ <strong>Avantage</strong><br>
Avoir dÃ©jÃ  un compte Stripe configurÃ© Ã©vite la phase d'inscription et de paramÃ©trage initial. Un gain de temps apprÃ©ciable.
</div>

<h3>âœ… Brevo : configuration rapide</h3>

<p>
Le projet demande de commencer par Brevo. Je crÃ©e le compte, configure ma premiÃ¨re API, je teste : <strong>Ã§a fonctionne</strong>. Rien de compliquÃ© Ã  ce stade, on verra l'intÃ©gration plus tard.
</p>

<h3>âš¡ Stripe : mise en place fluide</h3>

<p>
J'actualise mes informations Stripe, je crÃ©e ce qu'il faut. <strong>La crÃ©ation de l'API Xano pour appeler le paiement Stripe se passe bien</strong>. La configuration cÃ´tÃ© WeWeb est claire, j'envoie les infos nÃ©cessaires sans problÃ¨me.
</p>

<div class="callout callout-tip">
âœ¨ <strong>L'IA Xano utile</strong><br>
L'IA de Xano fait le travail si on lui explique bien ce qu'on veut. Attention cependant : elle a tendance Ã  vouloir tout supprimer dÃ¨s qu'on lui demande quelque chose. Ã€ utiliser avec prudence.
</div>

<p>
AprÃ¨s deux heures de projet, tout avance bien. Je fais une pause.
</p>

<h2>ğŸ˜¤ DifficultÃ©s rencontrÃ©es</h2>

<h3>ğŸ”¥ Le retour Stripe â†’ Xano : le mur</h3>

<p>
<strong>C'est lÃ  que tout se complique.</strong> Le retour de Stripe vers Xano via webhook est beaucoup plus complexe que prÃ©vu.
</p>

<p>
J'arrive bien Ã  appeler mon API depuis Stripe. Je vois l'input dans l'historique des requÃªtes Xano. <strong>Mais impossible de trouver comment rÃ©cupÃ©rer ces informations</strong> pour les exploiter comme variables dans mon API.
</p>

<div class="callout callout-warning">
âš ï¸ <strong>Le blocage majeur</strong><br>
J'y passe plusieurs heures. Ce problÃ¨me reprÃ©sente <strong>80% du temps total du projet</strong>. La documentation Xano n'est pas claire sur ce point prÃ©cis, et les forums ne donnent pas de rÃ©ponse directe.
</div>

<h3>ğŸ” Le problÃ¨me en dÃ©tail</h3>

<p>
Quand Stripe envoie un webhook, les donnÃ©es arrivent dans un format "raw" (brut). Xano ne les interprÃ¨te pas automatiquement comme des inputs classiques. Il faut aller les chercher diffÃ©remment.
</p>

<pre><code>
Flux attendu :
Stripe webhook â†’ Xano API â†’ RÃ©cupÃ©rer les donnÃ©es â†’ Traitement

RÃ©alitÃ© :
Stripe webhook â†’ Xano API â†’ ??? â†’ Les donnÃ©es sont lÃ  mais invisibles
</code></pre>

<h3>ğŸ” Validation de clÃ© Stripe : problÃ¨me non rÃ©solu</h3>

<p>
Je rencontre Ã©galement un blocage sur le <strong>contrÃ´le de la clÃ© Stripe</strong> pour sÃ©curiser le paiement. MalgrÃ© un paramÃ©trage qui semble correct, le contrÃ´le renvoie toujours <code>false</code>.
</p>

<div class="callout callout-warning">
âš ï¸ <strong>Ã€ rÃ©soudre plus tard</strong><br>
Ce problÃ¨me sera traitÃ© dans le Projet 6 qui demande de finaliser cette sÃ©curisation.
</div>

<h2>ğŸ’ª Solutions et apprentissages</h2>

<h3>ğŸ¯ La solution : Get All Raw Input</h3>

<p>
AprÃ¨s des heures de recherche, je trouve enfin la solution : <strong>Get All Raw Input</strong>. Cette fonction Xano permet de rÃ©cupÃ©rer toutes les donnÃ©es brutes envoyÃ©es Ã  l'API, y compris celles des webhooks.
</p>

<div class="callout callout-tip">
âœ¨ <strong>La clÃ© du problÃ¨me</strong><br>
Dans Xano, utiliser "Get All Raw Input" au dÃ©but de l'API webhook permet de capturer les donnÃ©es Stripe brutes. Ensuite, on peut les parser et les utiliser comme variables normales.
</div>

<h3>âš¡ Brevo bouclÃ© en 10 minutes</h3>

<p>
Une fois le problÃ¨me webhook rÃ©solu, <strong>l'intÃ©gration Brevo prend 10 minutes</strong>. L'appel API pour envoyer l'email de confirmation est simple et direct.
</p>

<h3>ğŸ“Š RÃ©partition du temps</h3>

<table>
    <thead>
        <tr>
            <th>TÃ¢che</th>
            <th>Temps estimÃ©</th>
            <th>DifficultÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Configuration Brevo</td>
            <td>30 min</td>
            <td>Facile</td>
        </tr>
        <tr>
            <td>Configuration Stripe</td>
            <td>30 min</td>
            <td>Facile</td>
        </tr>
        <tr>
            <td>API Xano â†’ Stripe</td>
            <td>30 min</td>
            <td>Moyen</td>
        </tr>
        <tr>
            <td>Webhook Stripe â†’ Xano</td>
            <td>~4h</td>
            <td>Difficile</td>
        </tr>
        <tr>
            <td>IntÃ©gration Brevo finale</td>
            <td>10 min</td>
            <td>Facile</td>
        </tr>
    </tbody>
</table>

<h2>âœ¨ Points positifs</h2>

<h3>âš¡ RapiditÃ© sur les intÃ©grations classiques</h3>

<p>
Les intÃ©grations Stripe et Brevo "classiques" (hors webhook) sont <strong>simples et bien documentÃ©es</strong>. Quand on suit les Ã©tapes, Ã§a fonctionne.
</p>

<h3>ğŸ¤– L'IA Xano aide (parfois)</h3>

<p>
Quand on lui explique clairement ce qu'on veut, <strong>l'IA de Xano peut gÃ©nÃ©rer du code fonctionnel</strong>. Utile pour les tÃ¢ches rÃ©pÃ©titives ou les transformations de donnÃ©es.
</p>

<h3>ğŸ“š Apprentissage concret</h3>

<p>
Ce projet m'a fait comprendre concrÃ¨tement <strong>comment les webhooks fonctionnent</strong> et pourquoi ils sont si importants dans une architecture moderne. La thÃ©orie prend tout son sens.
</p>

<h2>ğŸ˜®â€ğŸ’¨ Points nÃ©gatifs</h2>

<h3>ğŸ˜¤ Xano, encore et toujours</h3>

<p>
<strong>Ã‡a me refroidit encore plus sur l'utilisation de Xano et son manque de souplesse.</strong> Des concepts simples deviennent compliquÃ©s Ã  cause d'une documentation lacunaire et d'une interface pas toujours intuitive.
</p>

<div class="callout callout-warning">
âš ï¸ <strong>Frustration rÃ©currente</strong><br>
Ce n'est pas la premiÃ¨re fois que Xano me fait perdre du temps sur des choses qui devraient Ãªtre simples. Le manque de documentation claire sur les cas d'usage avancÃ©s est un vrai problÃ¨me.
</div>

<h3>ğŸ“– Documentation webhook insuffisante</h3>

<p>
Trouver comment rÃ©cupÃ©rer les donnÃ©es d'un webhook dans Xano n'aurait pas dÃ» prendre 4 heures. <strong>Un exemple clair dans la documentation officielle aurait suffi.</strong>
</p>

<h3>ğŸ” SÃ©curitÃ© non finalisÃ©e</h3>

<p>
Ne pas rÃ©ussir Ã  valider la clÃ© Stripe est frustrant. C'est un Ã©lÃ©ment de sÃ©curitÃ© important qui reste en suspens jusqu'au Projet 6.
</p>

<h2>ğŸ“ Apprentissages clÃ©s</h2>

<div class="summary">
ğŸ“Œ <strong>Ce que j'ai retenu :</strong>
<ul>
    <li><strong>Get All Raw Input</strong> : fonction essentielle pour rÃ©cupÃ©rer les donnÃ©es brutes des webhooks dans Xano</li>
    <li><strong>Webhooks â‰  API classiques</strong> : les donnÃ©es n'arrivent pas de la mÃªme faÃ§on, il faut adapter la rÃ©cupÃ©ration</li>
    <li><strong>L'IA Xano avec prudence</strong> : utile mais elle peut supprimer du code existant si on ne fait pas attention</li>
    <li><strong>Stripe bien documentÃ©</strong> : l'intÃ©gration cÃ´tÃ© Stripe est claire, c'est cÃ´tÃ© Xano que Ã§a coince</li>
    <li><strong>Brevo simple</strong> : l'API d'emailing transactionnel est straightforward une fois configurÃ©e</li>
    <li><strong>80/20 inversÃ©</strong> : parfois 80% du temps est passÃ© sur 20% du travail (le webhook)</li>
    <li><strong>PersÃ©vÃ©rance</strong> : ne pas abandonner mÃªme quand la documentation fait dÃ©faut</li>
</ul>
</div>

<h2>ğŸ“Š Bilan global</h2>

<h3>âœ… Validation du projet</h3>

<p>
Projet bouclÃ© <strong>fin novembre 2025</strong> en environ <strong>6 heures de travail</strong>. Plus des deux tiers de ce temps ont Ã©tÃ© consacrÃ©s Ã  un seul problÃ¨me : la rÃ©cupÃ©ration des donnÃ©es webhook.
</p>

<h3>ğŸ¤” Ressenti gÃ©nÃ©ral</h3>

<p>
Un projet <strong>sympa sur le fond</strong> : comprendre comment connecter des services externes, gÃ©rer les paiements, envoyer des emails automatiques. C'est concret et utile.
</p>

<p>
Mais <strong>la forme avec Xano reste frustrante</strong>. Le manque de souplesse et de documentation claire transforme des tÃ¢ches simples en casse-tÃªte. En script "classique", le flux complet aurait pris une fraction du temps.
</p>

<div class="callout callout-warning">
âš ï¸ <strong>Point non rÃ©solu</strong><br>
La validation de la clÃ© Stripe reste Ã  faire. Le contrÃ´le renvoie systÃ©matiquement <code>false</code> malgrÃ© un paramÃ©trage apparemment correct. Ã€ traiter dans le Projet 6.
</div>

<h2>â¡ï¸ Et aprÃ¨s ?</h2>

<p>
Le Projet 6 permettra de <strong>finaliser la sÃ©curisation Stripe</strong>. En attendant, j'ai acquis une comprÃ©hension solide du flux de paiement et de l'intÃ©gration de services externes.
</p>

<div class="callout callout-tip">
âœ¨ <strong>Conseil pour les suivants</strong><br>
Si vous bloquez sur les webhooks Xano : cherchez "Get All Raw Input". C'est probablement la solution. Et n'hÃ©sitez pas Ã  demander de l'aide avant d'y passer 4 heures.
</div>

<h2>ğŸ”— Ressources utiles</h2>

<ul>
    <li><a href="https://stripe.com/docs" target="_blank">Documentation Stripe</a></li>
    <li><a href="https://developers.brevo.com/" target="_blank">Documentation API Brevo</a></li>
    <li><a href="https://docs.xano.com" target="_blank">Documentation Xano (en anglais)</a></li>
    <li><a href="https://www.weweb.io" target="_blank">WeWeb - Site officiel</a></li>
</ul>
