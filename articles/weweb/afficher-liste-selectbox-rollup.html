<h1>Afficher une liste de noms dans une SelectBox : comprendre la structure des collections WeWeb</h1>

<p><strong>Comprendre pourquoi WeWeb ajoute automatiquement [0] et comment accÃ©der au vrai tableau de donnÃ©es pour afficher tous les noms dans une SelectBox.</strong></p>

<!-- Metadata block -->
<div class="metadata">
    <p>ğŸ·ï¸ <strong>CatÃ©gorie:</strong> WeWeb</p>
    <p>ğŸ¯ <strong>Niveau:</strong> IntermÃ©diaire</p>
    <p>ğŸ” <strong>Mots-clÃ©s:</strong> rollup, Collections, SelectBox, Structure de donnÃ©es, Data binding, Formules WeWeb, Auto-insertion [0], get_all_categorie</p>
    <p>ğŸ“… <strong>Mise Ã  jour:</strong> 27/10/2025</p>
    <p>â±ï¸ <strong>Temps passÃ©:</strong> Moins d'1 heure</p>
    <p>âš™ï¸ <strong>Stack:</strong> WeWeb + Xano</p>
</div>

<!-- TL;DR -->
<div class="tldr">
âœ… <strong>TL;DR :</strong>
Pour afficher une liste de noms depuis une collection dans une SelectBox, utilisez <code>rollup(collection.data, "name")</code>. Ne vous fiez pas au <code>[0]</code> automatiquement insÃ©rÃ© par WeWeb quand vous cliquez : il montre UN Ã©lÃ©ment d'exemple, pas le tableau complet.
</div>

<h2>ğŸ¤” ProblÃ¨me rencontrÃ©</h2>

<p><strong>ğŸ¯ Objectif :</strong> Afficher la liste de tous les noms (<code>name</code>) de catÃ©gories dans une SelectBox WeWeb, Ã  partir de la collection <code>get_all_categorie</code>.</p>

<p><strong>ğŸš¨ Le blocage :</strong></p>
<ul>
    <li>La donnÃ©e retournÃ©e par <code>get_all_categorie</code> n'Ã©tait pas sous la forme habituelle <code>data.data[]</code>, mais directement accessible via <code>get_all_categorie.data</code></li>
    <li>En cliquant dans l'arbre de donnÃ©es WeWeb, le systÃ¨me ajoutait automatiquement <code>[0]</code></li>
    <li>Cela induisait en erreur : WeWeb montrait un <strong>exemple d'Ã©lÃ©ment</strong>, pas le tableau complet</li>
    <li>RÃ©sultat : les formules comme <code>rollup(get_all_categorie.data.data, "name")</code> ne fonctionnaient pas</li>
</ul>

<div class="callout callout-warning">
âš ï¸ <strong>Attention</strong><br>
Quand vous cliquez sur un tableau dans WeWeb, le systÃ¨me ajoute automatiquement <code>[0]</code> pour vous montrer la structure d'un Ã©lÃ©ment. Ce n'est PAS le chemin Ã  utiliser dans vos formules si vous voulez traiter tout le tableau !
</div>

<h2>ğŸ” Explication simplifiÃ©e</h2>

<h3>ğŸ“š Analogie : la bibliothÃ¨que</h3>

<p>Imaginons que votre collection est une bibliothÃ¨que :</p>

<ul>
    <li><strong><code>get_all_categorie.data</code></strong> â†’ toute la bibliothÃ¨que (tous les livres)</li>
    <li><strong><code>get_all_categorie.data[0]</code></strong> â†’ un seul livre (le premier)</li>
</ul>

<p>Quand vous voulez afficher <strong>tous les titres de livres</strong> dans une liste, vous avez besoin de parcourir toute la bibliothÃ¨que, pas de regarder un seul livre !</p>

<h3>ğŸ” Comprendre la structure des donnÃ©es</h3>

<p>Votre API retourne quelque chose comme Ã§a :</p>

<pre><code>{
  "data": [
    { "id": 1, "name": "VÃ©lo" },
    { "id": 2, "name": "Avion" },
    { "id": 3, "name": "PÃªche" }
  ]
}</code></pre>

<ul>
    <li><code>get_all_categorie.data</code> = le tableau complet <code>[{...}, {...}, {...}]</code></li>
    <li><code>get_all_categorie.data[0]</code> = seulement <code>{ "id": 1, "name": "VÃ©lo" }</code></li>
    <li><code>get_all_categorie.data[0].name</code> = seulement <code>"VÃ©lo"</code></li>
</ul>

<div class="callout callout-tip">
âœ¨ <strong>Astuce</strong><br>
Dans WeWeb, au lieu de cliquer dans l'arbre de donnÃ©es (qui ajoute automatiquement <code>[0]</code>), <strong>tapez manuellement</strong> le chemin pour accÃ©der au tableau complet : <code>get_all_categorie.data</code>
</div>

<h2>âŒ Les fausses pistes rencontrÃ©es</h2>

<table>
    <thead>
        <tr>
            <th>Fausse piste</th>
            <th>Pourquoi Ã§a ne marchait pas</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>map(get_all_categorie.data, item => item.name)</code></td>
            <td>Utile pour crÃ©er des objets <code>{label, value}</code>, mais <strong>inutile ici</strong> : tu voulais simplement un tableau de noms, pas transformer les donnÃ©es.</td>
        </tr>
        <tr>
            <td><code>rollup(get_all_categorie.data.data, "name")</code></td>
            <td><strong>Mauvais niveau de profondeur</strong> : ton API ne renvoie qu'un seul niveau <code>data</code>, pas un double <code>data.data</code>.</td>
        </tr>
        <tr>
            <td>Cliquer sur <code>data</code> dans l'arbre WeWeb</td>
            <td>WeWeb insÃ¨re automatiquement <code>[0]</code>, ce qui donne accÃ¨s Ã  <strong>un Ã©lÃ©ment</strong> du tableau, pas au tableau entier.</td>
        </tr>
    </tbody>
</table>

<p>Ces approches compliquaient inutilement un besoin simple.</p>

<h2>âœ… La solution fonctionnelle</h2>

<h3>ğŸ¯ La formule magique</h3>

<pre><code>rollup(get_all_categorie.data, "name")</code></pre>

<h3>ğŸ”¬ Pourquoi Ã§a marche ?</h3>

<ol>
    <li><strong><code>get_all_categorie.data</code></strong> est dÃ©jÃ  un tableau d'objets : <code>[{id: 1, name: "VÃ©lo"}, ...]</code></li>
    <li><strong><code>rollup()</code></strong> parcourt ce tableau et extrait la valeur de la clÃ© <code>"name"</code> pour chaque objet</li>
    <li><strong>RÃ©sultat</strong> : un tableau de noms : <code>["VÃ©lo", "Avion", "PÃªche"]</code></li>
</ol>

<h3>ğŸ“ Ã‰tapes dans WeWeb</h3>

<p><strong>Ã‰tape 1ï¸âƒ£ : Configurer la SelectBox</strong></p>
<ul>
    <li>SÃ©lectionnez votre composant SelectBox</li>
    <li>Allez dans les propriÃ©tÃ©s â†’ <strong>Options</strong></li>
</ul>

<p><strong>Ã‰tape 2ï¸âƒ£ : Utiliser la formule</strong></p>
<ul>
    <li>Au lieu de cliquer dans l'arbre de donnÃ©es, <strong>tapez manuellement</strong> :</li>
</ul>

<pre><code>rollup(get_all_categorie.data, "name")</code></pre>

<p><strong>Ã‰tape 3ï¸âƒ£ : VÃ©rifier le rÃ©sultat</strong></p>
<ul>
    <li>La SelectBox affiche maintenant tous les noms : <strong>VÃ©lo, Avion, PÃªche</strong></li>
</ul>

<div class="callout callout-tip">
âœ¨ <strong>Astuce</strong><br>
La fonction <code>rollup()</code> est trÃ¨s puissante : elle permet d'extraire n'importe quelle propriÃ©tÃ© d'un tableau d'objets. Par exemple, <code>rollup(users, "email")</code> retourne tous les emails des utilisateurs.
</div>

<h2>ğŸ§° Exemple concret avec code</h2>

<h3>ğŸ“Š Structure de donnÃ©es retournÃ©e par l'API</h3>

<pre><code>{
  "data": [
    {
      "id": 1,
      "name": "VÃ©lo",
      "created_at": 1698765432
    },
    {
      "id": 2,
      "name": "Avion",
      "created_at": 1698765433
    },
    {
      "id": 3,
      "name": "PÃªche",
      "created_at": 1698765434
    }
  ]
}</code></pre>

<h3>ğŸ¯ Configuration de la SelectBox</h3>

<p><strong>Options :</strong></p>
<pre><code>rollup(get_all_categorie.data, "name")</code></pre>

<p><strong>RÃ©sultat visuel dans la SelectBox :</strong></p>
<ul>
    <li>VÃ©lo</li>
    <li>Avion</li>
    <li>PÃªche</li>
</ul>

<h3>ğŸš€ Aller plus loin : crÃ©er des paires {label, value}</h3>

<p>Si vous voulez utiliser l'ID comme valeur interne et le nom comme label visible :</p>

<pre><code>map(get_all_categorie.data, item => ({
  label: item.name,
  value: item.id
}))</code></pre>

<div class="callout callout-advanced">
ğŸ”¬ <strong>Pour aller plus loin</strong><br>
La fonction <code>map()</code> est utile quand vous devez transformer la structure des donnÃ©es (par exemple pour crÃ©er des objets <code>{label, value}</code>). Mais pour simplement extraire une propriÃ©tÃ©, <code>rollup()</code> est plus simple et plus lisible.
</div>

<h2>ğŸ“Œ Ã€ retenir</h2>

<div class="summary">
ğŸ“Œ <strong>Ã€ retenir :</strong>
<ul>
  <li><strong>Ne pas confondre <code>collection.data</code> (tableau complet) et <code>collection.data[0]</code> (un Ã©lÃ©ment)</strong></li>
  <li><strong>Toujours taper manuellement le chemin</strong> pour accÃ©der au tableau complet, sans cliquer dans l'arbre</li>
  <li><strong>Utiliser <code>rollup()</code></strong> pour extraire simplement une propriÃ©tÃ© d'un tableau d'objets</li>
  <li><strong>WeWeb ajoute <code>[0]</code> automatiquement</strong> pour montrer un exemple, pas pour donner le bon chemin</li>
</ul>
</div>

<h2>ğŸ”— Liens utiles</h2>

<ul>
    <li><a href="https://docs.weweb.io/formulas/rollup.html" target="_blank">Documentation WeWeb : fonction rollup()</a></li>
    <li><a href="https://docs.weweb.io/data/collections.html" target="_blank">Documentation WeWeb : Collections</a></li>
    <li>Article connexe dans cette base : <em>Comprendre les formules WeWeb</em> (Ã  venir)</li>
</ul>

<h2>ğŸ§  Quiz rapide</h2>

<p><strong>Question :</strong> Quelle est la diffÃ©rence entre <code>collection.data</code> et <code>collection.data[0]</code> ?</p>

<details>
    <summary>âœ… Voir la rÃ©ponse</summary>
    <p><strong>RÃ©ponse :</strong></p>
    <ul>
        <li><code>collection.data</code> â†’ <strong>tout le tableau</strong> (tous les Ã©lÃ©ments)</li>
        <li><code>collection.data[0]</code> â†’ <strong>un seul Ã©lÃ©ment</strong> (le premier du tableau)</li>
    </ul>
    <p>Pour traiter tous les Ã©lÃ©ments avec une formule comme <code>rollup()</code> ou <code>map()</code>, il faut utiliser <code>collection.data</code> (le tableau complet).</p>
</details>
